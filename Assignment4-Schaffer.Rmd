---
title: "Assignment 4 Stats - Todd Schaffer"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Simulation of the Cob-Web model


```{r cars}
equprice <- 14
phi <- -0.6
supplyshock <-rnorm(10000, 0, sqrt(.25))

nrep<-10000
y<-0
y1<-y

for (i in 2:nrep){
  y1[i]= equprice + phi*y1[i-1]* (supplyshock[i])
}

y1.ts <- ts(y1)

```

## 2.Simulation Model Plot


```{r pressure, echo=FALSE}

plot.ts(y1[1:50])
abline(h=mean(y1))
```

## 3. ACF and PACF Functions and Oberserved Patterns
**Describe any pattern you observe in the acf (pacf) and provide explanations. Use lag.max=10.**

It appears there is a big spike in the ACF for the first period but, then nothing much afterwards. In the PACF, there apears to be some alternating trend spiking up and down but not much relationship between the periods. There could be an explantation of some seasonality.

```{r acf, echo=FALSE}

acf(y1, lag.max = 10)
pacf(y1, lag.max = 10)
```

## 4. Linear Regression of the prices

**What is the intercept?**
The intercept is -2.728 e-14 but, more so it basically starts at zero.

**What is the slope?**
The slope is 1.

**How do they relate to the parameters in the Cob-Web model?**
These values relate to the parameters of the cob-web model because the numbers will be close to its mean in the cobweb model. This would be similar without the supply shock.


```{r lm model, echo=FALSE}
library(dynlm)
dynlm(y1~L(y1,-1))
```

## 5. Oranges Price Model

```{r orange prices, echo=FALSE}

library(readxl)
data <- read_xls("Oranges(1).xls")
data <- na.omit(data)
orangeprices <- ts(data$Price_Oranges,frequency=8,start=1991)
orangeprices
```

## 6. Oranges Price Model Plot

```{r orange plot, echo=FALSE}

plot(orangeprices)
abline(h=mean(orangeprices))

```

## 7. Acf and Pacf of the price of Oranges

**Describe the differences between these plots and the ones generated by your simulation. Why do you think these differ?**

In the ACF plot, it appears that the there is some correlation between the previous periods wihin the first five periods. In the PACF plot, there is a big spike at the beginning and then it tends to taper off with some mid correlation around period 10. 

These plots differ signficantly because the ACF is only measuring the trend between the series and the lagged variables. The PACF is measuring instead the correlation of the residuals. We remove any found variation so it doesn't bias the next sample period.

```{r orange lot, echo=FALSE}
acf(orangeprices)
pacf(orangeprices)

```

## 8. Regression of Oranges

**What is the suggested value of phi?**
The suggested value of phi is 0.25401.

```{r orange ot, echo=FALSE}
neworanges <- diff(orangeprices)
lm.orange.model <- dynlm(neworanges~L(neworanges,-8))

```

## 9. Simulation with Phi value

```{r orange t, echo=FALSE}
equprice <- 14
phi <- .254
supplyshock <-rnorm(10000, 0, sqrt(.25))

nrep<-10000
op<-0
orangesim<-op
for (i in 2:nrep){
  orangesim[i]= equprice + phi*orangesim[i-1]* (supplyshock[i])
}



plot.ts(orangesim[1:50])
abline(h=mean(orangesim))

```


## 10. Oberservation ofPhi

**Does the series created fluctuate up and down more or less? Explain how the positive value of phi changes the simulation you carried out in 1). **

The series appears to fluctuate less and appears to hug around the equprice fairly closely. The positive value of phi seems to show that it converges back to the mean. This postive vlaue of phi looks to condense the variation less than a negative phi.This positive phi may have helped to reduce the noise that was in the orginial simulation.


